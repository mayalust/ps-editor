<config defaultRouter = "true"
    injector="$scope,$q,$timeout,psCommand"
></config>
<template>
  <div>
    <div class="toppart">
      <button ng-click="save()"
          class="btn-xs btn-success pull-right">
        保存
      </button>
      <button ng-disabled="waitings.length + commands.length == 0"
          ng-click="history()"
          class="btn-xs btn-default pull-right">
        历史
      </button>
      <button ng-disabled="waitings.length == 0"
          ng-click="redo()"
          class="btn-xs btn-default pull-right">
        重做
      </button>
      <button ng-disabled="commands.length == 0"
          ng-click="undo()"
          class="btn-xs btn-default pull-right">
        撤销
      </button>
      <button ng-click="setting()"
          class="btn-xs btn-default pull-right">
        全局设置
      </button>
    </div>
    <div class="leftpart">
      <free-board-left
          data-tools="tools">
      </free-board-left>
    </div>
    <div class="rightpart">
      <!--
      <free-board-preview
          data-options="options">
      </free-board-preview>-->
      <div class="free-board-wrap">
        <free-board
            data-options="options">
        </free-board>
      </div>
    </div>
  </div>
</template>
<script type="text/javascript">
  export default function(scope,q,timeout,psCommand){
    scope.tools = [{
      label : `输入框`,
      data : {
        type : `input`,
        val : 9
      }
    }];
    scope.options = [{
      type : `row`,
      children : [{
        type : `col`,
        col : 3,
        children : [{
          type : `input`,
          val : 0
        },{
          type : `input`,
          val : 1
        }]
      },{
        type : `col`,
        col : 9,
        children : [{
          type : `input`,
          val : 2
        }]
      }]
    },{
      type : `row`,
      children : [{
        type : `col`,
        col : 9,
        children : [{
          type : `input`,
          val : 3
        },{
          type : `input`,
          val : 4
        },{
          type : `input`,
          val : 5
        }]
      },{
        type : `col`,
        col : 3,
        children : []
      }]
    }];
    function $render(){
      scope.commands = psCommand.commands();
      scope.waitings = psCommand.waitings();
    }
    $render();
    scope.save = function(){

    }
    scope.history = function(){

    }
    scope.undo = function(){
      $render();
      psCommand.back();
    }
    scope.redo = function(){
      $render();
      psCommand.forward();
    }
    scope.setting = function(){

    }
  };
</script>
<style type="less">
  .toppart{
    position : absolute;
    height : 30px;
    width : 100%;
    background-color : #337ab7;
    z-index : 1;
    .btn-xs {
      margin : 3px 10px 0 0;
      &[disabled]{
        color : #999;
        background-color : #ddd;
        &:hover{
          background-color : #ddd;
        }
      }
    }
  }
  .leftpart{
    position : absolute;
    width : 250px;
    top : 0;
    bottom : 0;
    left : 0;
  }
  .rightpart{
    position : absolute;
    right : 0;
    top : 60px;
    bottom : 0;
    left : 250px;
    overflow-x : hidden;
    overflow-y : auto;
    .free-board-wrap{
      position : absolute;
      width : ~'calc( 100vw - 265px )';
      top : 0;
      bottom : 0;
      left : 0;
    }
  }
</style>